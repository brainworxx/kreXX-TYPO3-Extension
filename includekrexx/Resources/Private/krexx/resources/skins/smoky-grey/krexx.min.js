/*! kreXX: Krumo eXXtended | (C) 2014-2015 Brainworxx GmbH | http://opensource.org/licenses/LGPL-2.1 */
(function(a){function f(){}document.addEventListener("DOMContentLoaded",function(){f.onDocumentReady()});f.onDocumentReady=function(){a.draXX(".kwrapper",".kheadnote");a.addEvent(".kwrapper .kexpand","click",f.toggle);a.addEvent(".kwrapper .kel","click",f.setAdditionalData);a.addEvent(".kwrapper .kcollapse-me","click",f.collapse);a.addEvent(".kwrapper .kgencode","click",f.generateCode);f.setPayloadMaxHeight();a.addEvent(".kwrapper .kheadnote-wrapper .kclose","click",f.close);a.addEvent(".ktool-tabs .ktab:not(.ksearchbutton)",
"click",f.switchTab);a.addEvent(".kwrapper .keditable select, .kwrapper .keditable input:not(.ksearchfield)","change",a.setSetting);a.addEvent(".kwrapper .resetbutton","click",a.resetSetting);a.addEvent(".kwrapper .kcopyFrom","click",f.copyFrom);a.addEvent(".kwrapper .ksearchbutton, .kwrapper .ksearch .kclose","click",f.displaySearch);a.addEvent(".kwrapper .ksearchnow","click",f.performSearch);a.addEvent(".kwrapper .ksearchfield","keyup",f.searchfieldReturn);a.addEvent(".kfatalwrapper-outer","scroll",
f.checkSeachInViewport);f.expandConfig();"file:"===window.location.protocol&&f.disableForms()};f.copyFrom=function(b){b.preventDefault();b.stopPropagation();var d;b=a.getDataset(this,"domid");if(d=document.querySelector("#"+b)){var c=d.previousElementSibling;this.parentNode.insertBefore(d.cloneNode(!0),this.nextSibling);c=c.cloneNode(!0);this.parentNode.insertBefore(c,this.nextSibling);c.addEventListener("click",f.toggle);c.addEventListener("click",f.setAdditionalData);c.querySelector(".kgencode").addEventListener("click",
f.generateCode);c.querySelector(".kcollapse-me").addEventListener("click",f.collapse);var e=c.nextElementSibling.querySelectorAll(".kexpand");for(d=0;d<e.length;d++)e[d].addEventListener("click",f.toggle),e[d].addEventListener("click",f.setAdditionalData);e=c.nextElementSibling.querySelectorAll(".kcollapse-me");for(d=0;d<e.length;d++)e[d].addEventListener("click",f.collapse);e=c.nextElementSibling.querySelectorAll(".kgencode");for(d=0;d<e.length;d++)e[d].addEventListener("click",f.generateCode);e=
c.nextElementSibling.querySelectorAll(".kwrapper .kel");for(d=0;d<e.length;d++)e[d].addEventListener("click",f.setAdditionalData);e=c.nextElementSibling.querySelectorAll(".kwrapper .kcopyFrom");for(d=0;d<e.length;d++)e[d].addEventListener("click",f.copyFrom);a.findInDomlistByClass(c.children,"kname").innerHTML=a.findInDomlistByClass(this.children,"kname").innerHTML;e=c.nextElementSibling.getElementsByTagName("*");for(d=0;d<e.length;d++)e[d].removeAttribute("id");c.nextElementSibling.removeAttribute("id");
a.setDataset(c.parentNode,"domid",b);this.parentNode.removeChild(this)}};f.collapse=function(b){b.preventDefault();b.stopPropagation();b=b.target;var d=a.getParents(b,".kwrapper")[0];a.removeClass(d.querySelectorAll(".kfilterroot"),"kfilterroot");a.removeClass(d.querySelectorAll(".krootline"),"krootline");a.removeClass(d.querySelectorAll(".ktopline"),"ktopline");a.hasClass(b,"kcollapsed")?a.removeClass(".kcollapsed","kcollapsed"):(a.addClass(a.getParents(b,"div.kbg-wrapper > ul"),"kfilterroot"),a.addClass(a.getParents(b,
"ul.knode, li.kchild"),"krootline"),a.addClass([a.getParents(b,".krootline")[0]],"ktopline"),a.removeClass(d.querySelectorAll(".kcollapsed"),"kcollapsed"),a.addClass([b],"kcollapsed"))};var e=[];f.performSearch=function(b){function d(){a.removeClass(".ksearch-found-highlight","ksearch-found-highlight");e[h]=[];e[h][c]=[];e[h][c].data=[];for(var b=l.querySelectorAll("li span, li div.kpreview"),d=0;d<b.length;++d)-1<b[d].textContent.indexOf(c)&&(a.toggleClass(b[d],"ksearch-found-highlight"),e[h][c].data.push(b[d]));
e[h][c].pointer=-1}b.preventDefault();b.stopPropagation();var c=this.parentNode.querySelector(".ksearchfield").value;if(3<c.length){var h=a.getDataset(this,"instance");b=a.getDataset(this,"direction");for(var l=document.querySelector("#"+h+" .kpayload:not(.khidden)"),k=l.querySelectorAll(".kcollapsed"),m=0;m<k.length;m++)a.trigger(k[m],"click");"undefined"!=typeof e[h]?"undefined"==typeof e[h][c]&&d():d();"forward"==b?e[h][c].pointer++:e[h][c].pointer--;"undefined"==typeof e[h][c].data[e[h][c].pointer]&&
(e[h][c].pointer="forward"==b?0:e[h][c].data.length-1);this.parentNode.querySelector(".ksearch-state").textContent=e[h][c].pointer+" / "+(e[h][c].data.length-1);"undefined"!==typeof e[h][c].data[e[h][c].pointer]&&f.jumpTo(e[h][c].data[e[h][c].pointer])}else this.parentNode.querySelector(".ksearch-state").textContent="<- must be bigger than 3 characters"};f.displaySearch=function(b){b.preventDefault();b.stopPropagation();var d=a.getDataset(this.parentNode,"instance");b=document.querySelector("#search-"+
d);d=document.querySelector("#"+d+" .ksearchbutton");a.hasClass(b,"khidden")?(a.toggleClass(b,"khidden"),a.toggleClass(d,"kactive"),b.querySelector(".ksearchfield").focus()):(a.toggleClass(b,"khidden"),a.toggleClass(d,"kactive"),a.removeClass(".ksearch-found-highlight","ksearch-found-highlight"),e=[])};f.toggle=function(b){b.stopPropagation();a.toggleClass(this,"kopened");a.toggleClass(this.nextElementSibling,"khidden")};var c;f.jumpTo=function(b){var d=a.getParents(b,".knest"),e;a.removeClass(d,
"khidden");for(var f=0;f<d.length;f++)a.addClass([d[f].previousElementSibling],"kopened");a.removeClass(".highlight-jumpto","highlight-jumpto");a.addClass([b],"highlight-jumpto");e=a.getParents(b,".kpayload");e.push(document.querySelector(".kfatalwrapper-outer"));if(0<e.length){var l,k=b.getBoundingClientRect().top-e[0].getBoundingClientRect().top+e[0].scrollTop-50;l=e[0].scrollTop<k?10:-10;clearInterval(c);var m=e[0].scrollTop;c=setInterval(function(){e[0].scrollTop+=l;(Math.abs(e[0].scrollTop-k)<=
Math.abs(l)||e[0].scrollTop==m)&&clearInterval(c);m=e[0].scrollTop},1)}};f.close=function(b){b.preventDefault();b.stopPropagation();b=a.getDataset(b.target,"instance");var d=document.querySelector("#"+b),c=1,e=setInterval(function(){0>c?(clearInterval(e),d.parentNode.removeChild(d)):(c-=.1,d.style.opacity=c)},20)};f.disableForms=function(){for(var a=document.querySelectorAll(".kwrapper .keditable input, .kwrapper .keditable select"),d=0;d<a.length;d++)a[d].disabled=!0};f.generateCode=function(b){b.preventDefault();
b.stopPropagation();for(var d=b.target.nextElementSibling,c="",e,f=a.getParents(b.target,"li.kchild")[0];f;){e=a.getDataset(f,"domid");b=a.getDataset(f,"source");"undefined"!==typeof b&&". . ."==b&&"undefined"!==typeof e&&(f=document.querySelector("#"+e).parentNode,b=a.getDataset(f,"source"));if("undefined"!==typeof b)if(". . ."==b){c="// Value is either protected or private.<br /> // Sorry . . ";break}else c=b+c;f=a.getParents(f,"li.kchild")[0]}d.innerHTML='<div class="kcode-inner">'+c+";</div>";
"none"==d.style.display?(d.style.display="",a.selectText(d)):d.style.display="none"};f.switchTab=function(b){b.preventDefault();b.stopPropagation();b=a.getDataset(this.parentNode,"instance");var d=a.getDataset(this,"what");a.removeClass("#"+b+" .kactive:not(.ksearchbutton)","kactive");this.classList?this.classList.add("kactive"):this.className+=" kactive";a.addClass("#"+b+" .kpayload","khidden");a.removeClass("#"+b+" ."+d,"khidden")};f.setPayloadMaxHeight=function(){var a=Math.round(.7*Math.max(document.documentElement.clientHeight,
window.innerHeight||0));if(0<a)for(var d=document.querySelectorAll(".krela-wrapper .kpayload"),c=0;c<d.length;c++)d[c].style.maxHeight=a+"px"};f.setAdditionalData=function(b){var c=a.getParents(this,".kwrapper")[0];if("undefined"!==typeof c){b=c.querySelector(".kdatabody");var e="",f=0;a.removeClass(c.querySelectorAll(".kcurrent-additional"),"kcurrent-additional");a.addClass([this],"kcurrent-additional");c=a.getDataset(this,"addjson");c=JSON.parse(c);if("object"===typeof c)for(var l in c)0<c[l].length&&
(e+="<tr><td>"+l+"</td><td>"+c[l]+"</td></tr>",f++);0==f&&(e="<tr><td>No data available for this item.</td><td>Sorry.</td></tr>");b.parentNode.parentNode.innerHTML='<table><caption class="kheadline">Additional data</caption><tbody class="kdatabody">'+e+"</tbody></table>"}};f.checkSeachInViewport=function(a){a=document.querySelector(".kfatalwrapper-outer .search-wrapper");a.style.position="";a.style.top="";0>a.getBoundingClientRect().top&&(a.style.position="fixed",a.style.top="0px")};f.searchfieldReturn=
function(b){b.preventDefault();b.stopPropagation();13==b.which&&a.trigger(this.parentNode.querySelectorAll(".ksearchnow")[1],"click")};f.expandConfig=function(){for(var b=document.querySelectorAll(".kconfiguration"),c,e=0;e<b.length;e++)c=b[e].querySelectorAll(".kchild .kexpand"),a.toggleClass(c[0],"kopened"),a.toggleClass(c[0].nextElementSibling,"khidden")}})(kreXXdomTools);